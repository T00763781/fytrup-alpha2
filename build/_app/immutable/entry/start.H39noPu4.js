import{t as Se,o as ke}from"../chunks/scheduler.oYtYXvQl.js";import{H as q,N as Y,f as Qe,g as Ae,i as Oe,a as de,P as Re,s as Te,b as J,r as ne,o as $e,S as ct,c as V,d as lt,e as et,h as ft}from"../chunks/singletons.CY3vAGaw.js";new URL("sveltekit-internal://");function bt(e,a){return e==="/"||a==="ignore"?e:a==="never"?e.endsWith("/")?e.slice(0,-1):e:a==="always"&&!e.endsWith("/")?e+"/":e}function Et(e){return e.split("%25").map(decodeURI).join("%25")}function St(e){for(const a in e)e[a]=decodeURIComponent(e[a]);return e}function Ie({href:e}){return e.split("#")[0]}const kt=["href","pathname","search","toString","toJSON"];function At(e,a,c){const o=new URL(e);Object.defineProperty(o,"searchParams",{value:new Proxy(o.searchParams,{get(u,f){if(f==="get"||f==="getAll"||f==="has")return l=>(c(l),u[f](l));a();const v=Reflect.get(u,f);return typeof v=="function"?v.bind(u):v}}),enumerable:!0,configurable:!0});for(const u of kt)Object.defineProperty(o,u,{get(){return a(),e[u]},enumerable:!0,configurable:!0});return Ot(o),o}function Ot(e){Object.defineProperty(e,"hash",{get(){throw new Error("Cannot access event.url.hash. Consider using `$page.url.hash` inside a component instead")}})}const Rt="/__data.json",$t=".html__data.json";function It(e){return e.endsWith(".html")?e.replace(/\.html$/,$t):e.replace(/\/$/,"")+Rt}function Pt(...e){let a=5381;for(const c of e)if(typeof c=="string"){let o=c.length;for(;o;)a=a*33^c.charCodeAt(--o)}else if(ArrayBuffer.isView(c)){const o=new Uint8Array(c.buffer,c.byteOffset,c.byteLength);let u=o.length;for(;u;)a=a*33^o[--u]}else throw new TypeError("value must be a string or TypedArray");return(a>>>0).toString(36)}const ut=window.fetch;window.fetch=(e,a)=>((e instanceof Request?e.method:a?.method||"GET")!=="GET"&&ae.delete(Ce(e)),ut(e,a));const ae=new Map;function jt(e){const a=atob(e),c=new Uint8Array(a.length);for(let o=0;o<a.length;o++)c[o]=a.charCodeAt(o);return c.buffer}function xt(e,a){const c=Ce(e,a),o=document.querySelector(c);if(o?.textContent){let{body:u,...f}=JSON.parse(o.textContent);const v=o.getAttribute("data-ttl");return v&&ae.set(c,{body:u,init:f,ttl:1e3*Number(v)}),o.getAttribute("data-b64")!==null&&(u=jt(u)),Promise.resolve(new Response(u,f))}return window.fetch(e,a)}function Nt(e,a,c){if(ae.size>0){const o=Ce(e,c),u=ae.get(o);if(u){if(performance.now()<u.ttl&&["default","force-cache","only-if-cached",void 0].includes(c?.cache))return new Response(u.body,u.init);ae.delete(o)}}return window.fetch(a,c)}function Ce(e,a){let o=`script[data-sveltekit-fetched][data-url=${JSON.stringify(e instanceof Request?e.url:e)}]`;if(a?.headers||a?.body){const u=[];a.headers&&u.push([...new Headers(a.headers)].join(",")),a.body&&(typeof a.body=="string"||ArrayBuffer.isView(a.body))&&u.push(a.body),o+=`[data-hash="${Pt(...u)}"]`}return o}const Lt=/^(\[)?(\.\.\.)?(\w+)(?:=(\w+))?(\])?$/;function Ut(e){const a=[];return{pattern:e==="/"?/^\/$/:new RegExp(`^${Ct(e).map(o=>{const u=/^\[\.\.\.(\w+)(?:=(\w+))?\]$/.exec(o);if(u)return a.push({name:u[1],matcher:u[2],optional:!1,rest:!0,chained:!0}),"(?:/(.*))?";const f=/^\[\[(\w+)(?:=(\w+))?\]\]$/.exec(o);if(f)return a.push({name:f[1],matcher:f[2],optional:!0,rest:!1,chained:!0}),"(?:/([^/]+))?";if(!o)return;const v=o.split(/\[(.+?)\](?!\])/);return"/"+v.map((g,s)=>{if(s%2){if(g.startsWith("x+"))return Pe(String.fromCharCode(parseInt(g.slice(2),16)));if(g.startsWith("u+"))return Pe(String.fromCharCode(...g.slice(2).split("-").map(T=>parseInt(T,16))));const h=Lt.exec(g);if(!h)throw new Error(`Invalid param: ${g}. Params and matcher names can only have underscores and alphanumeric characters.`);const[,w,I,S,$]=h;return a.push({name:S,matcher:$,optional:!!w,rest:!!I,chained:I?s===1&&v[0]==="":!1}),I?"(.*?)":w?"([^/]*)?":"([^/]+?)"}return Pe(g)}).join("")}).join("")}/?$`),params:a}}function Tt(e){return!/^\([^)]+\)$/.test(e)}function Ct(e){return e.slice(1).split("/").filter(Tt)}function Dt(e,a,c){const o={},u=e.slice(1),f=u.filter(l=>l!==void 0);let v=0;for(let l=0;l<a.length;l+=1){const g=a[l];let s=u[l-v];if(g.chained&&g.rest&&v&&(s=u.slice(l-v,l+1).filter(h=>h).join("/"),v=0),s===void 0){g.rest&&(o[g.name]="");continue}if(!g.matcher||c[g.matcher](s)){o[g.name]=s;const h=a[l+1],w=u[l+1];h&&!h.rest&&h.optional&&w&&g.chained&&(v=0),!h&&!w&&Object.keys(o).length===f.length&&(v=0);continue}if(g.optional&&g.chained){v++;continue}return}if(!v)return o}function Pe(e){return e.normalize().replace(/[[\]]/g,"\\$&").replace(/%/g,"%25").replace(/\//g,"%2[Ff]").replace(/\?/g,"%3[Ff]").replace(/#/g,"%23").replace(/[.*+?^${}()|\\]/g,"\\$&")}function Mt({nodes:e,server_loads:a,dictionary:c,matchers:o}){const u=new Set(a);return Object.entries(c).map(([l,[g,s,h]])=>{const{pattern:w,params:I}=Ut(l),S={id:l,exec:$=>{const T=w.exec($);if(T)return Dt(T,I,o)},errors:[1,...h||[]].map($=>e[$]),layouts:[0,...s||[]].map(v),leaf:f(g)};return S.errors.length=S.layouts.length=Math.max(S.errors.length,S.layouts.length),S});function f(l){const g=l<0;return g&&(l=~l),[g,e[l]]}function v(l){return l===void 0?l:[u.has(l),e[l]]}}function De(e,a=JSON.parse){try{return a(sessionStorage[e])}catch{}}function je(e,a,c=JSON.stringify){const o=c(a);try{sessionStorage[e]=o}catch{}}class xe extends Error{constructor(a,c){super(a),this.name="DevalueError",this.path=c.join("")}}function tt(e){return Object(e)!==e}const Ft=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Vt(e){const a=Object.getPrototypeOf(e);return a===Object.prototype||a===null||Object.getOwnPropertyNames(a).sort().join("\0")===Ft}function Bt(e){return Object.prototype.toString.call(e).slice(8,-1)}function Ht(e){switch(e){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e<" "?`\\u${e.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}function Z(e){let a="",c=0;const o=e.length;for(let u=0;u<o;u+=1){const f=e[u],v=Ht(f);v&&(a+=e.slice(c,u)+v,c=u+1)}return`"${c===0?e:a+e.slice(c)}"`}const Me=-1,dt=-2,pt=-3,ht=-4,_t=-5,Fe=-6;function qt(e,a){return gt(JSON.parse(e),a)}function gt(e,a){if(typeof e=="number")return u(e,!0);if(!Array.isArray(e)||e.length===0)throw new Error("Invalid input");const c=e,o=Array(c.length);function u(f,v=!1){if(f===Me)return;if(f===pt)return NaN;if(f===ht)return 1/0;if(f===_t)return-1/0;if(f===Fe)return-0;if(v)throw new Error("Invalid input");if(f in o)return o[f];const l=c[f];if(!l||typeof l!="object")o[f]=l;else if(Array.isArray(l))if(typeof l[0]=="string"){const g=l[0],s=a?.[g];if(s)return o[f]=s(u(l[1]));switch(g){case"Date":o[f]=new Date(l[1]);break;case"Set":const h=new Set;o[f]=h;for(let S=1;S<l.length;S+=1)h.add(u(l[S]));break;case"Map":const w=new Map;o[f]=w;for(let S=1;S<l.length;S+=2)w.set(u(l[S]),u(l[S+1]));break;case"RegExp":o[f]=new RegExp(l[1],l[2]);break;case"Object":o[f]=Object(l[1]);break;case"BigInt":o[f]=BigInt(l[1]);break;case"null":const I=Object.create(null);o[f]=I;for(let S=1;S<l.length;S+=2)I[l[S]]=u(l[S+1]);break;default:throw new Error(`Unknown type ${g}`)}}else{const g=new Array(l.length);o[f]=g;for(let s=0;s<l.length;s+=1){const h=l[s];h!==dt&&(g[s]=u(h))}}else{const g={};o[f]=g;for(const s in l){const h=l[s];g[s]=u(h)}}return o[f]}return u(0)}function Jt(e,a){const c=[],o=new Map,u=[];for(const s in a)u.push({key:s,fn:a[s]});const f=[];let v=0;function l(s){if(typeof s=="function")throw new xe("Cannot stringify a function",f);if(o.has(s))return o.get(s);if(s===void 0)return Me;if(Number.isNaN(s))return pt;if(s===1/0)return ht;if(s===-1/0)return _t;if(s===0&&1/s<0)return Fe;const h=v++;o.set(s,h);for(const{key:I,fn:S}of u){const $=S(s);if($)return c[h]=`["${I}",${l($)}]`,h}let w="";if(tt(s))w=Ne(s);else switch(Bt(s)){case"Number":case"String":case"Boolean":w=`["Object",${Ne(s)}]`;break;case"BigInt":w=`["BigInt",${s}]`;break;case"Date":w=`["Date","${!isNaN(s.getDate())?s.toISOString():""}"]`;break;case"RegExp":const{source:$,flags:T}=s;w=T?`["RegExp",${Z($)},"${T}"]`:`["RegExp",${Z($)}]`;break;case"Array":w="[";for(let R=0;R<s.length;R+=1)R>0&&(w+=","),R in s?(f.push(`[${R}]`),w+=l(s[R]),f.pop()):w+=dt;w+="]";break;case"Set":w='["Set"';for(const R of s)w+=`,${l(R)}`;w+="]";break;case"Map":w='["Map"';for(const[R,F]of s)f.push(`.get(${tt(R)?Ne(R):"..."})`),w+=`,${l(R)},${l(F)}`,f.pop();w+="]";break;default:if(!Vt(s))throw new xe("Cannot stringify arbitrary non-POJOs",f);if(Object.getOwnPropertySymbols(s).length>0)throw new xe("Cannot stringify POJOs with symbolic keys",f);if(Object.getPrototypeOf(s)===null){w='["null"';for(const R in s)f.push(`.${R}`),w+=`,${Z(R)},${l(s[R])}`,f.pop();w+="]"}else{w="{";let R=!1;for(const F in s)R&&(w+=","),R=!0,f.push(`.${F}`),w+=`${Z(F)}:${l(s[F])}`,f.pop();w+="}"}}return c[h]=w,h}const g=l(e);return g<0?`${g}`:`[${c.join(",")}]`}function Ne(e){const a=typeof e;return a==="string"?Z(e):e instanceof String?Z(e.toString()):e===void 0?Me.toString():e===0&&1/e<0?Fe.toString():a==="bigint"?`["BigInt","${e}"]`:String(e)}const mt=new Set(["load","prerender","csr","ssr","trailingSlash","config"]);[...mt];const Gt=new Set([...mt]);[...Gt];function Kt(e){return e.filter(a=>a!=null)}class _e{constructor(a,c){this.status=a,typeof c=="string"?this.body={message:c}:c?this.body=c:this.body={message:`Error: ${a}`}}toString(){return JSON.stringify(this.body)}}class nt{constructor(a,c){this.status=a,this.location=c}}class Ve extends Error{constructor(a,c,o){super(o),this.status=a,this.text=c}}const Yt="x-sveltekit-invalidated",zt="x-sveltekit-trailing-slash";function pe(e){return e instanceof _e||e instanceof Ve?e.status:500}function Wt(e){return e instanceof Ve?e.text:"Internal Error"}const z=De(ct)??{},re=De(lt,qt)??{},oe=De(ft)??{},rt=history.pushState,he=history.replaceState;function Le(e){z[e]=Te()}function at(e,a){let c=e+1;for(;z[c];)delete z[c],c+=1;for(c=a+1;oe[c];)delete oe[c],c+=1}function X(e){return location.href=e.href,new Promise(()=>{})}function ot(){}function Xt(e,a){const c=Mt(e),o=e.nodes[0],u=e.nodes[1];o(),u();const f=document.documentElement,v=[],l=[];let g=null;const s={before_navigate:[],on_navigate:[],after_navigate:[]};let h={branch:[],error:null,url:null},w=!1,I=!1,S=!0,$=!1,T=!1,R=!1,F=!1,se=!1,B,N=history.state?.[q],M=history.state?.[Y];N||(N=M=Date.now(),he.call(history,{...history.state,[q]:N,[Y]:M},"",location.href));const ge=z[N];ge&&(history.scrollRestoration="manual",scrollTo(ge.x,ge.y));let j,W,me;async function Be(){if(await(me||=Promise.resolve()),!me)return;me=null;const n=ee(h.url,!0);g=null;const t=W={},r=n&&await we(n);t===W&&(r&&(r.type==="redirect"?await ie(new URL(r.location,h.url).href,{},1,t):(r.props.page!==void 0&&(j=r.props.page),B.$set(r.props))),v.length=0)}function He(n){l.some(t=>t?.snapshot)&&(oe[n]=l.map(t=>t?.snapshot?.capture()))}function qe(n){oe[n]?.forEach((t,r)=>{l[r]?.snapshot?.restore(t)})}function Je(){Le(N),je(ct,z),He(M),je(ft,oe),je(lt,re,Jt)}async function ie(n,t,r,i){return fe({type:"goto",url:ne(n),keepfocus:t.keepFocus,noscroll:t.noScroll,replace_state:t.replaceState,redirect_count:r,state:t.state,nav_token:i,accept:()=>{t.invalidateAll&&(se=!0)}})}async function Ge(n){return g={id:n.id,promise:we(n).then(t=>(t.type==="loaded"&&t.state.error&&(g=null),t))},g.promise}async function ce(n){const t=c.find(r=>r.exec(We(n)));t&&await Promise.all([...t.layouts,t.leaf].map(r=>r?.[1]()))}function Ke(n){h=n.state;const t=document.querySelector("style[data-sveltekit]");t&&t.remove(),j=n.props.page,B=new e.root({target:a,props:{...n.props,stores:J,components:l},hydrate:!0}),qe(M);const r={from:null,to:{params:h.params,route:{id:h.route?.id??null},url:new URL(location.href)},willUnload:!1,type:"enter",complete:Promise.resolve()};s.after_navigate.forEach(i=>i(r)),I=!0}async function Q({url:n,params:t,branch:r,status:i,error:d,route:p,form:_}){let y="never";for(const A of r)A?.slash!==void 0&&(y=A.slash);n.pathname=bt(n.pathname,y),n.search=n.search;const E={type:"loaded",state:{url:n,params:t,branch:r,error:d,route:p},props:{constructors:Kt(r).map(A=>A.node.component),page:j}};_!==void 0&&(E.props.form=_);let b={},L=!j,U=0;for(let A=0;A<Math.max(r.length,h.branch.length);A+=1){const x=r[A],O=h.branch[A];x?.data!==O?.data&&(L=!0),x&&(b={...b,...x.data},L&&(E.props[`data_${U}`]=b),U+=1)}return(!h.url||n.href!==h.url.href||h.error!==d||_!==void 0&&_!==j.form||L)&&(E.props.page={error:d,params:t,route:{id:p?.id??null},state:{},status:i,url:new URL(n),form:_??null,data:L?b:j.data}),E}async function ye({loader:n,parent:t,url:r,params:i,route:d,server_data_node:p}){let _=null,y=!0;const E={dependencies:new Set,params:new Set,parent:!1,route:!1,url:!1,search_params:new Set},b=await n();if(b.universal?.load){let L=function(...m){for(const A of m){const{href:x}=new URL(A,r);E.dependencies.add(x)}};const U={route:new Proxy(d,{get:(m,A)=>(y&&(E.route=!0),m[A])}),params:new Proxy(i,{get:(m,A)=>(y&&E.params.add(A),m[A])}),data:p?.data??null,url:At(r,()=>{y&&(E.url=!0)},m=>{y&&E.search_params.add(m)}),async fetch(m,A){let x;m instanceof Request?(x=m.url,A={body:m.method==="GET"||m.method==="HEAD"?void 0:await m.blob(),cache:m.cache,credentials:m.credentials,headers:m.headers,integrity:m.integrity,keepalive:m.keepalive,method:m.method,mode:m.mode,redirect:m.redirect,referrer:m.referrer,referrerPolicy:m.referrerPolicy,signal:m.signal,...A}):x=m;const O=new URL(x,r);return y&&L(O.href),O.origin===r.origin&&(x=O.href.slice(r.origin.length)),I?Nt(x,O.href,A):xt(x,A)},setHeaders:()=>{},depends:L,parent(){return y&&(E.parent=!0),t()},untrack(m){y=!1;try{return m()}finally{y=!0}}};_=await b.universal.load.call(null,U)??null}return{node:b,loader:n,server:p,universal:b.universal?.load?{type:"data",data:_,uses:E}:null,data:_??p?.data??null,slash:V&&(r.pathname===V||r.pathname===V+"/")?"always":b.universal?.trailingSlash??p?.slash}}function Ye(n,t,r,i,d,p){if(se)return!0;if(!d)return!1;if(d.parent&&n||d.route&&t||d.url&&r)return!0;for(const _ of d.search_params)if(i.has(_))return!0;for(const _ of d.params)if(p[_]!==h.params[_])return!0;for(const _ of d.dependencies)if(v.some(y=>y(new URL(_))))return!0;return!1}function ve(n,t){return n?.type==="data"?n:n?.type==="skip"?t??null:null}function vt(n,t){if(!n)return new Set(t.searchParams.keys());const r=new Set([...n.searchParams.keys(),...t.searchParams.keys()]);for(const i of r){const d=n.searchParams.getAll(i),p=t.searchParams.getAll(i);d.every(_=>p.includes(_))&&p.every(_=>d.includes(_))&&r.delete(i)}return r}async function we({id:n,invalidating:t,url:r,params:i,route:d}){if(g?.id===n)return g.promise;const{errors:p,layouts:_,leaf:y}=d,E=[..._,y];p.forEach(k=>k?.().catch(()=>{})),E.forEach(k=>k?.[1]().catch(()=>{}));let b=null;const L=h.url?n!==h.url.pathname+h.url.search:!1,U=h.route?d.id!==h.route.id:!1,m=vt(h.url,r);let A=!1;const x=E.map((k,P)=>{const C=h.branch[P],D=!!k?.[0]&&(C?.loader!==k[1]||Ye(A,U,L,m,C.server?.uses,i));return D&&(A=!0),D});if(x.some(Boolean)){try{b=await st(r,x)}catch(k){return le({status:pe(k),error:await te(k,{url:r,params:i,route:{id:d.id}}),url:r,route:d})}if(b.type==="redirect")return b}const O=b?.nodes;let H=!1;const G=E.map(async(k,P)=>{if(!k)return;const C=h.branch[P],D=O?.[P];if((!D||D.type==="skip")&&k[1]===C?.loader&&!Ye(H,U,L,m,C.universal?.uses,i))return C;if(H=!0,D?.type==="error")throw D;return ye({loader:k[1],url:r,params:i,route:d,parent:async()=>{const be={};for(let Ee=0;Ee<P;Ee+=1)Object.assign(be,(await G[Ee])?.data);return be},server_data_node:ve(D===void 0&&k[0]?{type:"skip"}:D??null,k[0]?C?.server:void 0)})});for(const k of G)k.catch(()=>{});const K=[];for(let k=0;k<E.length;k+=1)if(E[k])try{K.push(await G[k])}catch(P){if(P instanceof nt)return{type:"redirect",location:P.location};let C=pe(P),D;if(O?.includes(P))C=P.status??C,D=P.error;else if(P instanceof _e)D=P.body;else{if(await J.updated.check())return await X(r);D=await te(P,{params:i,url:r,route:{id:d.id}})}const ue=await ze(k,K,p);return ue?await Q({url:r,params:i,branch:K.slice(0,ue.idx).concat(ue.node),status:C,error:D,route:d}):await Ze(r,{id:d.id},D,C)}else K.push(void 0);return await Q({url:r,params:i,branch:K,status:200,error:null,route:d,form:t?void 0:null})}async function ze(n,t,r){for(;n--;)if(r[n]){let i=n;for(;!t[i];)i-=1;try{return{idx:i+1,node:{node:await r[n](),loader:r[n],data:{},server:null,universal:null}}}catch{continue}}}async function le({status:n,error:t,url:r,route:i}){const d={};let p=null;if(e.server_loads[0]===0)try{const b=await st(r,[!0]);if(b.type!=="data"||b.nodes[0]&&b.nodes[0].type!=="data")throw 0;p=b.nodes[0]??null}catch{(r.origin!==$e||r.pathname!==location.pathname||w)&&await X(r)}const y=await ye({loader:o,url:r,params:d,route:i,parent:()=>Promise.resolve({}),server_data_node:ve(p)}),E={node:await u(),loader:u,universal:null,server:null,data:null};return await Q({url:r,params:d,branch:[y,E],status:n,error:t,route:null})}function ee(n,t){if(Oe(n,V))return;const r=We(n.pathname);for(const i of c){const d=i.exec(r);if(d)return{id:n.pathname+n.search,invalidating:t,route:i,params:St(d),url:n}}}function We(n){return Et(n.slice(V.length)||"/")}function Xe({url:n,type:t,intent:r,delta:i}){let d=!1;const p=it(h,r,n,t);i!==void 0&&(p.navigation.delta=i);const _={...p.navigation,cancel:()=>{d=!0,p.reject(new Error("navigation was cancelled"))}};return T||s.before_navigate.forEach(y=>y(_)),d?null:p}async function fe({type:n,url:t,popped:r,keepfocus:i,noscroll:d,replace_state:p,state:_={},redirect_count:y=0,nav_token:E={},accept:b=ot,block:L=ot}){const U=ee(t,!1),m=Xe({url:t,type:n,delta:r?.delta,intent:U});if(!m){L();return}const A=N,x=M;b(),T=!0,I&&J.navigating.set(m.navigation),W=E;let O=U&&await we(U);if(!O){if(Oe(t,V))return await X(t);O=await Ze(t,{id:null},await te(new Ve(404,"Not Found",`Not found: ${t.pathname}`),{url:t,params:{},route:{id:null}}),404)}if(t=U?.url||t,W!==E)return m.reject(new Error("navigation was aborted")),!1;if(O.type==="redirect")if(y>=20)O=await le({status:500,error:await te(new Error("Redirect loop"),{url:t,params:{},route:{id:null}}),url:t,route:{id:null}});else return ie(new URL(O.location,t).href,{},y+1,E),!1;else O.props.page.status>=400&&await J.updated.check()&&await X(t);if(v.length=0,se=!1,$=!0,Le(A),He(x),O.props.page.url.pathname!==t.pathname&&(t.pathname=O.props.page.url.pathname),_=r?r.state:_,!r){const k=p?0:1,P={[q]:N+=k,[Y]:M+=k};(p?he:rt).call(history,P,"",t),p||at(N,M)}if(re[N]=_,g=null,O.props.page.state=_,I){h=O.state,O.props.page&&(O.props.page.url=t);const k=(await Promise.all(s.on_navigate.map(P=>P(m.navigation)))).filter(P=>typeof P=="function");if(k.length>0){let P=function(){s.after_navigate=s.after_navigate.filter(C=>!k.includes(C))};k.push(P),s.after_navigate.push(...k)}B.$set(O.props),F=!0}else Ke(O);const{activeElement:H}=document;await Se();const G=r?r.scroll:d?Te():null;if(S){const k=t.hash&&document.getElementById(decodeURIComponent(t.hash.slice(1)));G?scrollTo(G.x,G.y):k?k.scrollIntoView():scrollTo(0,0)}const K=document.activeElement!==H&&document.activeElement!==document.body;!i&&!K&&Ue(),S=!0,O.props.page&&(j=O.props.page),T=!1,n==="popstate"&&qe(M),m.fulfil(void 0),s.after_navigate.forEach(k=>k(m.navigation)),J.navigating.set(null),$=!1}async function Ze(n,t,r,i){return n.origin===$e&&n.pathname===location.pathname&&!w?await le({status:i,error:r,url:n,route:t}):await X(n)}function wt(){let n;f.addEventListener("mousemove",p=>{const _=p.target;clearTimeout(n),n=setTimeout(()=>{i(_,2)},20)});function t(p){i(p.composedPath()[0],1)}f.addEventListener("mousedown",t),f.addEventListener("touchstart",t,{passive:!0});const r=new IntersectionObserver(p=>{for(const _ of p)_.isIntersecting&&(ce(_.target.href),r.unobserve(_.target))},{threshold:0});function i(p,_){const y=Qe(p,f);if(!y)return;const{url:E,external:b,download:L}=Ae(y,V);if(b||L)return;const U=de(y);if(!U.reload)if(_<=U.preload_data){const m=ee(E,!1);m&&Ge(m)}else _<=U.preload_code&&ce(E.pathname)}function d(){r.disconnect();for(const p of f.querySelectorAll("a")){const{url:_,external:y,download:E}=Ae(p,V);if(y||E)continue;const b=de(p);b.reload||(b.preload_code===et.viewport&&r.observe(p),b.preload_code===et.eager&&ce(_.pathname))}}s.after_navigate.push(d),d()}function te(n,t){if(n instanceof _e)return n.body;const r=pe(n),i=Wt(n);return e.hooks.handleError({error:n,event:t,status:r,message:i})??{message:i}}return{after_navigate:n=>{ke(()=>(s.after_navigate.push(n),()=>{const t=s.after_navigate.indexOf(n);s.after_navigate.splice(t,1)}))},before_navigate:n=>{ke(()=>(s.before_navigate.push(n),()=>{const t=s.before_navigate.indexOf(n);s.before_navigate.splice(t,1)}))},on_navigate:n=>{ke(()=>(s.on_navigate.push(n),()=>{const t=s.on_navigate.indexOf(n);s.on_navigate.splice(t,1)}))},disable_scroll_handling:()=>{($||!I)&&(S=!1)},goto:(n,t={})=>(n=ne(n),n.origin!==$e?Promise.reject(new Error("goto: invalid URL")):ie(n,t,0)),invalidate:n=>{if(typeof n=="function")v.push(n);else{const{href:t}=new URL(n,location.href);v.push(r=>r.href===t)}return Be()},invalidate_all:()=>(se=!0,Be()),preload_data:async n=>{const t=ne(n),r=ee(t,!1);if(!r)throw new Error(`Attempted to preload a URL that does not belong to this app: ${t}`);const i=await Ge(r);if(i.type==="redirect")return{type:i.type,location:i.location};const{status:d,data:p}=i.props.page??j;return{type:i.type,status:d,data:p}},preload_code:n=>ce(n),push_state:(n,t)=>{const r={[q]:N+=1,[Y]:M,[Re]:j.url.href};rt.call(history,r,"",ne(n)),j={...j,state:t},B.$set({page:j}),re[N]=t,at(N,M)},replace_state:(n,t)=>{const r={[q]:N,[Y]:M,[Re]:j.url.href};he.call(history,r,"",ne(n)),j={...j,state:t},B.$set({page:j}),re[N]=t},apply_action:async n=>{if(n.type==="error"){const t=new URL(location.href),{branch:r,route:i}=h;if(!i)return;const d=await ze(h.branch.length,r,i.errors);if(d){const p=await Q({url:t,params:h.params,branch:r.slice(0,d.idx).concat(d.node),status:n.status??500,error:n.error,route:i});h=p.state,B.$set(p.props),Se().then(Ue)}}else n.type==="redirect"?ie(n.location,{invalidateAll:!0},0):(B.$set({form:null,page:{...j,form:n.data,status:n.status}}),await Se(),B.$set({form:n.data}),n.type==="success"&&Ue())},_start_router:()=>{history.scrollRestoration="manual",addEventListener("beforeunload",t=>{let r=!1;if(Je(),!T){const i=it(h,void 0,null,"leave"),d={...i.navigation,cancel:()=>{r=!0,i.reject(new Error("navigation was cancelled"))}};s.before_navigate.forEach(p=>p(d))}r?(t.preventDefault(),t.returnValue=""):history.scrollRestoration="auto"}),addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&Je()}),navigator.connection?.saveData||wt(),f.addEventListener("click",t=>{if(t.button||t.which!==1||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.defaultPrevented)return;const r=Qe(t.composedPath()[0],f);if(!r)return;const{url:i,external:d,target:p,download:_}=Ae(r,V);if(!i)return;if(p==="_parent"||p==="_top"){if(window.parent!==window)return}else if(p&&p!=="_self")return;const y=de(r);if(!(r instanceof SVGAElement)&&i.protocol!==location.protocol&&!(i.protocol==="https:"||i.protocol==="http:")||_)return;if(d||y.reload){Xe({url:i,type:"link"})?T=!0:t.preventDefault();return}const[b,L]=i.href.split("#");if(L!==void 0&&b===Ie(location)){if(h.url.hash===i.hash){t.preventDefault(),r.ownerDocument.getElementById(L)?.scrollIntoView();return}if(R=!0,Le(N),n(i),!y.replace_state)return;R=!1}t.preventDefault(),fe({type:"link",url:i,keepfocus:y.keepfocus,noscroll:y.noscroll,replace_state:y.replace_state??i.href===location.href})}),f.addEventListener("submit",t=>{if(t.defaultPrevented)return;const r=HTMLFormElement.prototype.cloneNode.call(t.target),i=t.submitter;if((i?.formMethod||r.method)!=="get")return;const p=new URL(i?.hasAttribute("formaction")&&i?.formAction||r.action);if(Oe(p,V))return;const _=t.target,y=de(_);if(y.reload)return;t.preventDefault(),t.stopPropagation();const E=new FormData(_),b=i?.getAttribute("name");b&&E.append(b,i?.getAttribute("value")??""),p.search=new URLSearchParams(E).toString(),fe({type:"form",url:p,keepfocus:y.keepfocus,noscroll:y.noscroll,replace_state:y.replace_state??p.href===location.href})}),addEventListener("popstate",async t=>{if(t.state?.[q]){const r=t.state[q];if(W={},r===N)return;const i=z[r],d=re[r]??{},p=new URL(t.state[Re]??location.href),_=t.state[Y],y=Ie(location)===Ie(h.url);if(_===M&&(F||y)){n(p),z[N]=Te(),i&&scrollTo(i.x,i.y),d!==j.state&&(j={...j,state:d},B.$set({page:j})),N=r;return}const b=r-N;await fe({type:"popstate",url:p,popped:{state:d,scroll:i,delta:b},accept:()=>{N=r,M=_},block:()=>{history.go(-b)},nav_token:W})}else if(!R){const r=new URL(location.href);n(r)}}),addEventListener("hashchange",()=>{R&&(R=!1,he.call(history,{...history.state,[q]:++N,[Y]:M},"",location.href))});for(const t of document.querySelectorAll("link"))t.rel==="icon"&&(t.href=t.href);addEventListener("pageshow",t=>{t.persisted&&J.navigating.set(null)});function n(t){h.url=t,J.page.set({...j,url:t}),J.page.notify()}},_hydrate:async({status:n=200,error:t,node_ids:r,params:i,route:d,data:p,form:_})=>{w=!0;const y=new URL(location.href);({params:i={},route:d={id:null}}=ee(y,!1)||{});let E;try{const b=r.map(async(m,A)=>{const x=p[A];return x?.uses&&(x.uses=yt(x.uses)),ye({loader:e.nodes[m],url:y,params:i,route:d,parent:async()=>{const O={};for(let H=0;H<A;H+=1)Object.assign(O,(await b[H]).data);return O},server_data_node:ve(x)})}),L=await Promise.all(b),U=c.find(({id:m})=>m===d.id);if(U){const m=U.layouts;for(let A=0;A<m.length;A++)m[A]||L.splice(A,0,void 0)}E=await Q({url:y,params:i,branch:L,status:n,error:t,form:_,route:U??null})}catch(b){if(b instanceof nt){await X(new URL(b.location,location.href));return}E=await le({status:pe(b),error:await te(b,{url:y,params:i,route:d}),url:y,route:d})}E.props.page&&(E.props.page.state={}),Ke(E)}}}async function st(e,a){const c=new URL(e);c.pathname=It(e.pathname),e.pathname.endsWith("/")&&c.searchParams.append(zt,"1"),c.searchParams.append(Yt,a.map(u=>u?"1":"0").join(""));const o=await ut(c.href);if(!o.ok){let u;throw o.headers.get("content-type")?.includes("application/json")?u=await o.json():o.status===404?u="Not Found":o.status===500&&(u="Internal Error"),new _e(o.status,u)}return new Promise(async u=>{const f=new Map,v=o.body.getReader(),l=new TextDecoder;function g(h){return gt(h,{Promise:w=>new Promise((I,S)=>{f.set(w,{fulfil:I,reject:S})})})}let s="";for(;;){const{done:h,value:w}=await v.read();if(h&&!s)break;for(s+=!w&&s?`
`:l.decode(w);;){const I=s.indexOf(`
`);if(I===-1)break;const S=JSON.parse(s.slice(0,I));if(s=s.slice(I+1),S.type==="redirect")return u(S);if(S.type==="data")S.nodes?.forEach($=>{$?.type==="data"&&($.uses=yt($.uses),$.data=g($.data))}),u(S);else if(S.type==="chunk"){const{id:$,data:T,error:R}=S,F=f.get($);f.delete($),R?F.reject(g(R)):F.fulfil(g(T))}}}})}function yt(e){return{dependencies:new Set(e?.dependencies??[]),params:new Set(e?.params??[]),parent:!!e?.parent,route:!!e?.route,url:!!e?.url,search_params:new Set(e?.search_params??[])}}function Ue(){const e=document.querySelector("[autofocus]");if(e)e.focus();else{const a=document.body,c=a.getAttribute("tabindex");a.tabIndex=-1,a.focus({preventScroll:!0,focusVisible:!1}),c!==null?a.setAttribute("tabindex",c):a.removeAttribute("tabindex");const o=getSelection();if(o&&o.type!=="None"){const u=[];for(let f=0;f<o.rangeCount;f+=1)u.push(o.getRangeAt(f));setTimeout(()=>{if(o.rangeCount===u.length){for(let f=0;f<o.rangeCount;f+=1){const v=u[f],l=o.getRangeAt(f);if(v.commonAncestorContainer!==l.commonAncestorContainer||v.startContainer!==l.startContainer||v.endContainer!==l.endContainer||v.startOffset!==l.startOffset||v.endOffset!==l.endOffset)return}o.removeAllRanges()}})}}}function it(e,a,c,o){let u,f;const v=new Promise((g,s)=>{u=g,f=s});return v.catch(()=>{}),{navigation:{from:{params:e.params,route:{id:e.route?.id??null},url:e.url},to:c&&{params:a?.params??null,route:{id:a?.route?.id??null},url:c},willUnload:!a,type:o,complete:v},fulfil:u,reject:f}}async function en(e,a,c){const o=Xt(e,a);c?await o._hydrate(c):o.goto(location.href,{replaceState:!0}),o._start_router()}export{en as start};
